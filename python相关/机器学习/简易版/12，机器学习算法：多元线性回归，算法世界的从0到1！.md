# 多元线性回归

<img src="imgs/image-20230315134353656.png" alt="image-20230315134353656" style="zoom: 25%;" />



根据历史数据训练模型，未来预测具体数值的任务就是回归任务，

<img src="imgs/v2-b8a04f16693ce51fba723b7383a39405_r.jpg" alt="机器学习模型预测股票 - 知乎" style="zoom: 50%;" />

1.  股票价格预测
2.  房价预测（影响因素：房屋的面积、卧室数量、浴室数量、车库数量等等）
3.  销售量预测
4.  贷款违约率预测

**多元线性回归**就是众多回归算法中的一个，也是最基础的一个



### 何为多元？多个维度 multi dimensionality

<img src="imgs/Curse-of-Dimensionality-i2tutorials.png" alt="What do you mean by Curse of Dimensionality? What are the different ways to  deal with it? | i2tutorials" style="zoom:50%;" />

更高的维度很难绘制出来；不过我们可以思考一下我们生活的世界是几维空间？

其实随时随地都能在脑海种构建一个多维空间。比如，房屋的售价取决于很多因素，比如房屋的面积、卧室数量、浴室数量、车库数量等等。



### 何为线性？二维空间：直线

<img src="imgs/linear-vs-non-linear-learning-2.png" alt="Linear vs Non Linear Learning – Thrive Anyway" style="zoom:50%;" />

三维空间：平面

<img src="imgs/BttwR.png" alt="geometry - How can I find the angle of the surface/3D Plane. - Mathematics  Stack Exchange" style="zoom:50%;" />

更高维度空间中呈现出来的"线性体"，我们统称为超平面hyper plane；



### 何为回归？回归其实就是拟合

二维世界的一元线性回归：下图左

二维世界的一元非线性回归：下图右

![Types of Linear Regression | HackerNoon](imgs/h31rz24si.jpg)

三维世界的线性回归：

<img src="imgs/multiple_regression_representation_hyperplane.jpg" alt="Statistics - Multiple Linear Regression | Data Mining | Datacadamia - Data  and Co" style="zoom:50%;" />

三维世界的非线性回归：

<img src="imgs/2Fyu5.png" alt="plotting - How to visualize 3D fit - Mathematica Stack Exchange" style="zoom: 80%;" />



>   综上所述，多元线性回归顾名思义就是，在多元世界（多维空间）中使用线性体（直线、平面、超平面）对已有数据点进行拟合的一种方式方法（算法or函数）！

![豁然开朗表情包 的图像结果](imgs/OGC.fa6098273f5df08c7900afe0bb03ec51pid=1.7&rurl=http%3a%2f%2fimg.soogif.com%2fh8qs9brBEvybbYqgaH5DkmuHmLFrYThC.gif)



### 线性回归公式（算法表达式）

一元线性回归
$$
\hat{Y}=w_0+w_1x_1
$$
多元线性回归
$$
\hat{Y}=w_0+w_1x_1+w_2x_2+\ldots+w_nx_n
$$



### 何时使用线性回归？

<img src="imgs/5f3a434b0444d964f1005ce5_3.1.1.1.1-Linear-Regression.png" alt="The Ultimate Guide to Linear Regression for Machine Learning" style="zoom:50%;" />

1.  如果我们知道我们的数据$X={x_1\ldots x_n}$和$Y$大致是成线性变换关系的，当然使用线性回归算法显然是合适的！
2.  只要我们假设$X={x_1\ldots x_n}$和$Y$是成线性变换的，就可以尝试去使用线性回归算法去拟合，万一合适呢？



### 使用几元线性回归？

<img src="imgs/multiple_regression_representation_hyperplane.jpg" alt="Statistics - Multiple Linear Regression | Data Mining | Datacadamia - Data  and Co" style="zoom:50%;" />

使用几元线性回归决定了我们使用什么样的公式

这个由数据决定，数据$X={x_1\ldots x_n}$中的$n$将决定了是几维空间中的回归任务



### 如何求解算法模型

![image-20230315145746941](imgs/image-20230315145746941.png)

根据数据我们知道是使用一元线性回归还是多元线性回归，

<img src="imgs/5f3a434b0444d964f1005ce5_3.1.1.1.1-Linear-Regression-167886502694031.png" alt="The Ultimate Guide to Linear Regression for Machine Learning" style="zoom:50%;" />

然后我们可以把数据中的$X={x_1\ldots x_n}$带入到算法公式中，
$$
\hat{Y}=w_0+w_1x_1+w_2x_2+\ldots+w_nx_n
$$
而我们的数据中有没有$Y$呢？必须有的，所以我们可以计算真实值$Y$和预测值$\hat{Y}$之间的均方差(Mean Squared Error)，

![線性回歸- 维基百科，自由的百科全书](https://upload.wikimedia.org/wikipedia/commons/3/3a/Linear_regression.svg)

这是回归任务最常用的损失函数
$$
MSE=\frac{1}{m}\sum_{i=1}^{m}(Y_i-\hat{Y_i})^2
$$
不同的算法模型（公式参数）有不同的损失值，

<img src="imgs/mse2.png" alt="03.1 均方差损失函数- AI-EDU" style="zoom: 67%;" />

我们需要计算机不断调整参数最后找出来最优解参数（最佳模型）

