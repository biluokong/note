定义去训练模型的逻辑

```python
def train_step(data, target, model, optimizer):
    optimizer.zero_grad()
    output = model(data)
    loss = F.nll_loss(output, target)
    loss.backward()
    optimizer.step()
    return loss
```



定义测试模型的逻辑

```python
def test_step(data, target, model, test_loss, correct):
    output = model(data)
    test_loss += F.nll_loss(output, target, reduction='sum').item()  # 累积批次的损失
    pred = output.argmax(dim=1, keepdim=True)  # 获得对数概率最大值对应的索引号
    correct += pred.eq(target.view_as(pred)).sum().item()
    return test_loss, correct
```

