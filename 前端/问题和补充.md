# é—®é¢˜

## node.jsé—®é¢˜

### åˆ›å»ºvueé¡¹ç›®å¤±è´¥

å¯èƒ½æ˜¯æ–‡ä»¶æƒé™ä¸å¤Ÿ

### ä¾èµ–å®‰è£…å¤±è´¥

å¦‚æœæŠ¥é”™æç¤ºæ˜¯ä»æŸurlä¸‹è½½èµ„æºå¤±è´¥ï¼Œé‚£å¯èƒ½æ˜¯è¿™ä¸ªåœ°å€å·²ç»å¤±æ•ˆæˆ–è¯ä¹¦è¿‡æœŸäº†ï¼Œå¦‚æœåŸå› æ˜¯è¿™ä¸ªï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š

- è¯·æ£€æŸ¥`package-lock.json`é‡Œç›¸å…³ä¾èµ–çš„`resolved`å€¼ï¼Œå°†urlçš„åŸŸåéƒ¨åˆ†ä¿®æ”¹ä¸ºå¯è®¿é—®çš„æ–°åŸŸåï¼Œé‡æ–°`install`
- åˆ é™¤`package-lock.json`ï¼Œé‡æ–°`npm install`ç”Ÿæˆæ–°çš„ã€‚

> é€šç”¨æ–¹æ¡ˆï¼šåŠ ä¸Š`--force`å‚æ•°ï¼š`npm install --force`

### è¿è¡ŒæŠ¥é”™

æŠ¥é”™ï¼šError: Rule can only have one resource source (provided resource and test + include + excl...

å¤§æ¦‚ç‡æ˜¯`webpack`ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯ä»¥æ¢ä¸€ä¸ªç‰ˆæœ¬çš„webpackã€‚

> æç«¯æ”¹æ³•ï¼šåˆ é™¤`node_modules`å’Œ`package-lock.json`ï¼Œæ‰‹åŠ¨åœ¨`package.json`çš„`devDependencies`é‡ŒåŠ ä¸Š`â€œwebpackâ€:"^4.23.0"`ï¼Œç„¶å`npm install --force`

### å®‰è£…node-sasså¤±è´¥

æŠ¥é”™ä¿¡æ¯ï¼šnpm ERR! path G:\test\mvs\mvs-frontend\node_modules\node-sass

åŸå› ï¼šnode-sassç‰ˆæœ¬å’Œnodejsç‰ˆæœ¬ä¸å…¼å®¹

å®˜ç½‘ä¸­https://www.npmjs.com/package/node-sasså¯ä»¥çœ‹åˆ°nodeJsä¸å…¶æ”¯æŒçš„node-sassç‰ˆæœ¬çš„å¯¹åº”å…³ç³»ã€‚

è§£å†³æ–¹æ³•ï¼š

- æ–¹æ³•1ï¼šæœ€ç®€å•çš„æ–¹æ³•ï¼Œè¿è¡Œ`npm install node-sass@npm:sass --ignore-scripts`

- æ–¹æ³•2ï¼šä½¿ç”¨nvmåˆ‡æ¢nodeJsçš„ç‰ˆæœ¬ æˆ– ä¿®æ”¹`package.json`ä¸­`node-sass`çš„ç‰ˆæœ¬å·

| NodeJS  | Supported node-sass version | Node Module |
| ------- | --------------------------- | ----------- |
| Node 16 | 6.0+                        | 93          |
| Node 15 | 5.0+                        | 88          |
| Node 14 | 4.14+                       | 83          |
| Node 13 | 4.13+, <5.0                 | 79          |
| Node 12 | 4.12+                       | 72          |
| Node 11 | 4.10+, <5.0                 | 67          |
| Node 10 | 4.9+, <6.0                  | 64          |
| Node 8  | 4.5.3+, <5.0                | 57          |
| Node<8  | <5.0                        | <57         |

> ä¿®æ”¹ç‰ˆæœ¬åé‡æ–°å®‰è£…`node install --force`å¯èƒ½æŠ¥é”™æç¤º â€œæ‰¾ä¸åˆ°node-sass/vendorâ€ ï¼Œæ­¤æ—¶åªéœ€`npm rebuild node-sass -g`é‡å»ºä¾èµ–å³å¯

### å®‰è£…chromedriverå¤±è´¥

è‡ªå·±æ ¹æ®ç»ˆç«¯ç»™çš„é“¾æ¥ä¸‹è½½åˆ°ç›¸åº”ä½ç½®åï¼š` npm install chromedriver --chromedriver_filepath=C:\Users\797799421\AppData\Local\Temp\chromedriver\chromedriver_win32.zip`

### è¿è¡ŒæŠ¥é”™

- Module build failed: ReferenceError: globalThis is not defined
  - è§£å†³æ–¹æ³•ï¼šnodeå‡çº§åˆ°æ”¯æŒglobalThisçš„ç‰ˆæœ¬ï¼ˆv12æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰

## element-ui

### dialog

- ä½¿ç”¨`<el-dialog>` æ—¶å‡ºç°äº†é®ç½©å±‚æŠŠå¼¹æ¡†éƒ½é®ä½çš„æƒ…å†µã€‚è§£å†³æ–¹æ³•ï¼šç»™æ ‡ç­¾åŠ ä¸Š `append-to-body`

- å‡ºç°äº†é¡µé¢ï¼ˆå…ƒç´ ï¼‰çš„ç§»åŠ¨ï¼Œå®ƒçš„é®ç½©å±‚ä¼šç»™bodyåŠ ä¸Š`padding-right=20px`ã€‚é—®é¢˜åˆ†æï¼š[element e-dialogå¼¹çª—å¯¼è‡´é¡µé¢åç§»ï¼Œbodyä¸Šå¤šäº†æ ·å¼"padding-right: 17px" è§£å†³åŠæ³• - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7008495519794200612) è§£å†³æ–¹æ³•ï¼šæ ‡ç­¾ä¸ŠåŠ ä¸Š`:lock-scroll="false"`

### el-form

å¦‚æœä½¿ç”¨äº†è¡¨å•çš„`resetFields`æ–¹æ³•ï¼Œå³ä½¿å±æ€§ä¸éœ€è¦ä½¿ç”¨rulesæ ¡éªŒï¼Œä¹Ÿè¦åŠ ä¸Špropå±æ€§ï¼Œä¸ç„¶è¯¥è¡¨å•valueæ— æ³•è¢«é‡ç½®ã€‚

### el-table

- é¼ æ ‡ç»è¿‡è¡¨æ ¼èƒŒæ™¯è‰²ä¼šæ”¹å˜ï¼Œè®¾ç½®èƒŒæ™¯è‰²å›ºå®šæ–¹æ³•ï¼š

~~~vue
<!--ä½¿ç”¨å±æ€§cell-styleï¼Œå¦‚æœä¹Ÿæƒ³æ”¹å˜headerçš„èƒŒæ™¯è‰²ï¼Œå¯ä»¥ä½¿ç”¨header-cell-style -->
<el-table class="expand-table" :header-cell-style="{ background: '#fdf5e6' }" :cell-style="{ background: '#f0f9eb' }">
~~~

- åˆå¹¶è¡Œï¼šåˆå¹¶ç¬¬ä¸€åˆ—ç›¸åŒå€¼çš„è¡Œï¼ˆç›¸åŒå€¼çš„è¡Œå¯èƒ½ä¸ç›¸é‚»ï¼‰

> ä¸ºäº†ä¼˜åŒ–æ•ˆç‡ï¼Œå»ºè®®åœ¨è·å–æ•°æ®æ—¶æå‰è®¡ç®—å‡ºè¦åˆå¹¶çš„è¡Œã€‚

~~~vue
<template>
<el-table :data="" :span-method="mergeRow">
</template>

<script>
  getData() {
    //å‘é€è¯·æ±‚è·å–æ•°æ®ï¼Œä¾‹å¦‚æ•°æ®ä¸ºdataList
    this.getMergeInfo(this.dataList, 'type')
  }

  // keyæ˜¯æŒ‡å®šè¦è·å–å“ªä¸ªå­—æ®µçš„åˆå¹¶ä¿¡æ¯
  getMergeInfo(tableData, key) {
    let currValue = null, start = 0, length = 0
    const list = []
    tableData.forEach((item, index) => {
      // é‡åˆ°æ–°çš„å€¼ï¼Œä¿å­˜ä¸Šä¸€ä¸ªå€¼çš„åˆå¹¶ä¿¡æ¯
      if (item[key] !== currValue) {
        if (length > 0) {
          list.push({ start, length })
        }
        currValue = item[key]
        start = index
        length = 1
      } else {
        length++
      }
    })
    // æœ€åä¸€ç»„
    if (length > 0) {
      list.push({ start, length })
    }
    this.mergeInfo = list
  }

  mergeRow({ row, column, rowIndex, columnIndex }) {
    if (columnIndex === 0) {	// åˆå¹¶å­—æ®µçš„æ‰€åœ¨åˆ—
      const info = this.mergeInfo.find(item => rowIndex === item.start)
      return info ? [info.length, 1] : [0, 0]
    }
    return [1, 1] // é»˜è®¤ä¸åˆå¹¶
  }
</script>
~~~

- ä½¿ç”¨typeä¸º`expand`çš„è¡Œæ—¶ï¼Œå±•å¼€è¡Œé‡Œçš„å†…å®¹æ˜¾ç¤ºä¸å…¨ï¼Œä¸ä¼šè‡ªåŠ¨å‡ºç°æ»šåŠ¨æ¡ï¼Œè§£å†³æ–¹æ³•ï¼š

~~~css
.el-table::v-deep .el-table__body-wrapper {
  overflow-y: auto;
}
~~~



## vue

### $refs

ä½¿ç”¨$refsè·å–ç»„ä»¶æ—¶ï¼Œè·å–çš„å¯¹è±¡ä¸ºnull æˆ– è°ƒç”¨è·å–å¯¹è±¡çš„æ–¹æ³•/å±æ€§æŠ¥é”™ è¯¥å‡½æ•°/å±æ€§ä¸å­˜åœ¨ã€‚

åŸå› ï¼šç»„ä»¶è¿˜æœªæ¸²æŸ“å‡ºæ¥

è§£å†³æ–¹æ³•ï¼š

- ä½¿ç”¨`this.$nextTick(() => { ä¹‹å‰çš„ä»£ç å†™åœ¨è¿™ })`
  - nextTickï¼šè¯¥æ–¹æ³•ä¿è¯åœ¨ä¸‹æ¬¡äº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ
- vue2ä¸­ï¼šå¯ä»¥ä½¿ç”¨`setTimeout(() => { ä»£ç  }, 0)`ï¼Œä»¥è®©ä»£ç åœ¨ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ

### éå“åº”å¼æ•°æ®

æ·»åŠ /è¿½åŠ çš„åŠ¨æ€å±æ€§ï¼Œæ˜¯ä¸å…·å¤‡å“åº”å¼ç‰¹å®šçš„ã€‚

è§£å†³æ–¹æ³•ï¼šå¯ä»¥ç”¨`this.$set(ç›®æ ‡å¯¹è±¡, å±æ€§åç§°, åˆå§‹å€¼)`

~~~vue
<script>
  export default {
    name: '',
    data() {
      return {
				obj: {}
      }
    },
    methods: {
      getObj() {
        // è¿™æ ·æ·»åŠ çš„æ•°æ®æ˜¯å“åº”å¼çš„
        this.obj = {
          name: 'lisi',
          age: 12
        }
        // è¿™æ ·æ·»åŠ çš„æ•°æ®ä¸æ˜¯å“åº”å¼çš„
        this.obj.sex = 'ç”·'
        // åº”è¯¥è¿™ä¹ˆæ·»åŠ 
        this.$set(obj, sex, 'ç”·')
      }
    }
  }
</script>
~~~

### åˆ·æ–°404

historyæ¨¡å¼ä¸‹ï¼Œvue-router ä½¿ç”¨æµè§ˆå™¨çš„History APIæ¥ç®¡ç†è·¯ç”±ï¼Œå¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µä¸‹ä¿®æ”¹URLï¼›ä½†ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œé¡µé¢çš„urlå¹¶ä¸æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œæ‰€ä»¥åˆ·æ–°ä¼š404ã€‚

è§£å†³æ–¹æ³•ï¼šå¦‚æœä½¿ç”¨äº†nginxï¼Œå¯ä»¥å°†æ‰€æœ‰é¡µé¢ä»£ç†åˆ°index.htmlï¼ˆæ ¹é¡µé¢ï¼‰ï¼Œæ³¨æ„è§£å†³æŸäº›è·¯å¾„æ—¶çœŸçš„ä¸å­˜åœ¨çš„é—®é¢˜ï¼ˆæœ€ååŠ ä¸€ä¸ªè·¯ç”±ï¼š{ path: '*', component: NotFoundComponent }ï¼‰

### useRouter().xxxæŠ¥é”™

vue3ä¸­setupé‡Œé¢ï¼ŒuseRouter() è¿”å›çš„æ˜¯ä¸€ä¸ªå“åº”å¼çš„è·¯ç”±å¯¹è±¡ï¼Œè€Œç›´æ¥è®¿é—® .xxx å¯èƒ½ä¼šåœ¨è·¯ç”±åˆå§‹åŒ–ä¹‹å‰è¢«æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´æœªå®šä¹‰é”™è¯¯æˆ–å…¶ä»–é—®é¢˜ã€‚

é€šè¿‡ `const router = useRouter(); router.xxx` çš„æ–¹å¼å¯ä»¥ç¡®ä¿ useRouter() è¢«è°ƒç”¨ï¼Œå¹¶å°†è·¯ç”±å®ä¾‹ä¿å­˜åœ¨ router å˜é‡ä¸­ã€‚è¿™æ ·ï¼Œé€šè¿‡ `router.xxx` å°±èƒ½åœ¨æ­£ç¡®çš„æ—¶æœºã€åœ¨è·¯ç”±åˆå§‹åŒ–ä¹‹åè·å–åˆ°å½“å‰çš„è·¯ç”±ä¿¡æ¯ã€‚

å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ç›´æ¥å¼•å…¥routerï¼š`import router from '@/router'`

### pushæ–¹æ³•æŠ¥é”™

åœ¨évueæ–‡ä»¶ï¼Œå¦‚`js/ts`ä¸­ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨`useRouter`æ¥è·å–routerå¯¹è±¡çš„ï¼Œéœ€è¦ç›´æ¥å¼•å…¥routeræ¥ä½¿ç”¨

### 100vhæœ‰æ»šåŠ¨æ¡

å¦‚æœå­˜åœ¨å½“å‰é¡µé¢ä¸­çš„classåç§° å’Œ ç”¨åˆ°çš„å…¶ä»–ç»„ä»¶ä¸­çš„classåç§° **ä¸€æ ·**ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šé‡åˆ°è¿™ç§æƒ…å†µã€‚ä½ éœ€è¦å…ˆæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯

## æµè§ˆå™¨

### sockjsæŠ¥é”™

è§£å†³æ–¹æ³•ï¼šæ‰¾åˆ°/node_modules/sockjs-client/dist/sockjs.jsä¸­çš„`self.xhr.send(payload)`ï¼ŒæŠŠè¿™è¡Œæ³¨é‡Šæ‰å³å¯

## element-plus

### ElMessageä¸æ˜¾ç¤º

æè¿°ï¼šè‡ªåŠ¨å¯¼å…¥æ—¶ï¼Œè¯·æ±‚æ‹¦æˆªå™¨ä¸­ä½¿ç”¨ElMessage.error()ä¸æ˜¾ç¤ºï¼ˆè®¿é—®`"/"`æ—¶ï¼‰

è§£å†³æ–¹æ³•ï¼šæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯vscodeç»™ä½ è‡ªåŠ¨åŠ ä¸Šäº†`import { ElMessage } from 'element-plus'`ï¼ŒæŠŠè¯¥è‡ªåŠ¨å¯¼å…¥åˆ é™¤æ‰ã€‚

åŸå› ï¼šå½“é…ç½®äº†è‡ªåŠ¨å¯¼å…¥æ—¶ï¼Œå¦‚æœæ‰‹åŠ¨å¯¼å…¥äº†æŸç»„ä»¶æ—¶ï¼Œä¸€å®šè¦æ‰‹åŠ¨æŠŠè¯¥ç»„ä»¶çš„æ ·å¼å·²å¯¼å…¥ï¼›ä¸ç„¶ç”±äºç»„ä»¶ç¼ºå°‘æ ·å¼ï¼Œå¯¼è‡´æ— æ³•æ˜¾ç¤º

### v-loadingé—ªçƒ

`element-plus`æŒ‰é’®ä½¿ç”¨`v-loading+disabled`ï¼Œå…³é—­`loading`æ—¶é¡µé¢ä¼šé—ªä¸€ä¸‹ã€‚

~~~vue
<el-button type="danger" round @click="sendMsg" :disabled="loading" v-loading="loading">
    <el-icon color="var(--white_color)" size="18"><Promotion /></el-icon>
</el-button>
~~~

è§£å†³æ–¹æ³•ï¼šå°†`v-loading`å’Œ`disabled`åˆ†å¼€ä½¿ç”¨ã€‚

~~~vue
<div v-loading="loading">
    <el-button type="danger" round @click="sendMsg" :disabled="loading">
        <el-icon color="var(--white_color)" size="18"><Promotion /></el-icon>
    </el-button>
</div>
~~~



## TS

### å¯¼å…¥tsç±»å‹æŠ¥é”™

å…·ä½“ï¼šUncaught SyntaxError: The requested module '/node_modules/.vite/deps/vue-router.js?v=7c8084c9' does not provide an export named 'RouteRecordRaw'

åŸå› ï¼šä½¿ç”¨äº†export typeæ–¹å¼çš„å¯¼å‡ºç±»å‹ï¼Œéœ€è¦ç”¨import typeæ–¹å¼å¯¼å…¥ã€‚

~~~ts
// æ–¹æ³•1ï¼š
import { type RouteRecordRaw } from 'vue-router'
// æ–¹æ³•2ï¼š
import type { RouteRecordRaw } from 'vue-router'
~~~

è¡¥å……ï¼šTypescript 3.8`ç‰ˆæœ¬ä¸­ä¸“é—¨å¼•å…¥äº†`import type`å’Œ`export typeï¼Œ[ä½¿ç”¨åŸå› ]([import å’Œ import typeçš„åŒºåˆ« - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7111203210542448671))ã€‚åœ¨TypeScriptä¸­ï¼Œimport typeæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¼å…¥å½¢å¼ï¼Œå®ƒåªå¯¼å…¥ç±»å‹ï¼Œè€Œä¸å¯¼å…¥å€¼ã€‚è¿™æ„å‘³ç€**åœ¨è¿è¡Œæ—¶ï¼Œè¿™ç§å¯¼å…¥ä¸ä¼šäº§ç”Ÿä»»ä½•å®é™…çš„ä»£ç **ã€‚è¿™å¯¹äºé¿å…åœ¨JavaScriptè¾“å‡ºä¸­äº§ç”Ÿä¸å¿…è¦çš„ä»£ç ï¼Œæˆ–è€…è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜éå¸¸æœ‰ç”¨ã€‚

### å¯¼å…¥vueæ–‡ä»¶æŠ¥é”™

ç‚¹è¿› main.ts ä»¥åŠå…¶ä»–å¼•ç”¨äº† vue æ–‡ä»¶çš„åœ°æ–¹å‘ç°æŠ¥é”™ã€‚**Cannot find module 'xxx.vue' or its corresponding type declarations.ts(2307)**ã€‚
æŠ¥é”™åŸå› ï¼štypescript åªèƒ½ç†è§£ .ts æ–‡ä»¶ï¼Œæ— æ³•ç†è§£ .vueæ–‡ä»¶

è§£å†³æ–¹æ³•ï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•æˆ– src æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º shims-vue.d.ts çš„æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

~~~typescript
declare module '*.vue' {
  import { ComponentOptions } from 'vue'
  const componentOptions: ComponentOptions
  export default componentOptions
}
~~~

å¦‚æœæœ‰env.d.tsæ–‡ä»¶ï¼Œåˆ™æŠŠä»¥ä¸Šå†…å®¹å†™å…¥å³å¯ï¼Œä¸éœ€è¦å¦å¤–åˆ›å»ºshims-vue.d.tsã€‚

## axios

### è¯·æ±‚æ— Cookie

å¦ä¸€ç§è¡¨ç°å½¢å¼æ˜¯ï¼šæ¯æ¬¡è¯·æ±‚sessionIdéƒ½ä¼šä¸åŒã€‚è§£å†³æ–¹æ³•ä¸€æ ·

Axiosé»˜è®¤è¯·æ±‚ä¸ä¼šæºå¸¦Cookieï¼Œä½¿ç”¨éªŒè¯ç æ—¶æ— æ³•æ ¹æ®sessionIdè·å–éªŒè¯ç ï¼Œè§£å†³æ–¹æ³•ï¼š

~~~js
const request = axios.create({
  baseURL: 'http://localhost:5173/api',
  timeout: 5000,
  withCredentials: true	//è§£å†³ä¸æºå¸¦cookie
})
//æˆ–
request.defaults.withCredentials = true
~~~

åœ¨å¼€å¯`withCredentials: true`åï¼Œå¦‚æœæ˜¯è·¨åŸŸè¯·æ±‚ä¼šæŠ¥é”™ï¼Œéœ€è¦åç«¯è®¾ç½®ã€‚

- å¦‚æœå‰ç«¯ç”¨äº†ä»£ç†ï¼Œåˆ™ä¸ä¼šæœ‰æ­¤é—®é¢˜ï¼Œä½†è¦æ³¨æ„**localhostå’Œ127.0.0.1æ˜¯ä¸åŒçš„**ï¼Œå¦‚æœä»£ç†é…ç½®çš„localhostï¼Œåˆ™è®¿é—®é¡µé¢æ—¶å’Œå‘è¯·æ±‚ä¹Ÿè¦ç”¨localhostï¼Œä¸èƒ½ç”¨127.0.0.1ã€‚
- åç«¯ç›´æ¥é…ç½®å…è®¸è·¨åŸŸä¼šæŠ¥é”™ï¼šThe value of the 'Access-Control-Allow-Origin' header in the response must not be the wildcard '*' when the request's credentials mode is 'include'. è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š

~~~java
//Access-Control-Allow-Originä¸èƒ½å€¼ä¸º*ï¼Œåç«¯ä¼šæŠ¥é”™ï¼Œä¸Credentialsä¸ºtrueå†²çª
res.setHeader("Access-Control-Allow-Origin",req.getHeader("origin"));
		res.setHeader("Access-Control-Allow-Credentials","true");
~~~

### è¯·æ±‚ä¸‹è½½æ–‡ä»¶

é—®é¢˜ï¼šå¦‚æœè¯·æ±‚è¿”å›200ï¼Œå´æ²¡æœ‰è¿”å›æ•°æ®ï¼ˆæˆ–ä¸èƒ½æ¥å—åˆ°æ–‡ä»¶ï¼‰ã€‚

è§£å†³ï¼šçœ‹ä¸‹æ‹¦æˆªå™¨é‡Œæ˜¯å¦æ‹¦æˆªäº†è¯·æ±‚ï¼Œå› ä¸ºæ­¤æ—¶åç«¯è¯·æ±‚è¿”å›çš„ä¸æ˜¯Resultå¯¹è±¡äº†ï¼Œæ˜¯é€šè¿‡responseå¯¹è±¡å†™å›äºŒè¿›åˆ¶æ•°æ®ï¼›å¹¶ä¸”ç”±äºaxiosè®¾ç½®äº†responseTypeä¸º`blog`ï¼Œæ­¤æ—¶çš„res.dataæ˜¯Blogå¯¹è±¡ã€‚

```js


request.interceptors.response.use((response) => {
  const data = response.data
  if (data.type && data.type === 'application/octet-stream') {
    return response
  }
  if (data.code !== 200) {
    ElMessage.error(data.msg)
    return Promise.reject(data.msg)
  }
  return response
}export const exportAllCustomerApi = () => {
  return request.get('/customer/export', {
    //å¿…é¡»è®¾ç½®blogï¼Œå‘Šè¯‰axiosæ¥æ”¶
    responseType: 'blob'
  })
}

const batchExportExcel = async () => {
  const {data} = await exportAllCustomerApi()
  const objectUrl = URL.createObjectURL(data)
  let a = document.createElement('a')
  a.href = objectUrl
  a.download = 'å®¢æˆ·åˆ—è¡¨.xlsx'
  a.click()
}

request.interceptors.response.use((response) => {
  const data = response.data
  // dataä¸ºBlogå¯¹è±¡æ—¶ï¼Œæœ‰ä¸€ä¸ªå±æ€§typeï¼Œå€¼ä¸ºåç«¯è®¾ç½®çš„Content-Typeå€¼ï¼Œåç«¯æ¥å£æ–¹æ³•è¿”å›å€¼ä¸ºvoid
  if (data.type && data.type === 'application/octet-stream') {
    return response
  }
  // dataä¸ºåç«¯è¿”å›çš„Resultå¯¹è±¡æ—¶ï¼Œæœ‰dataã€codeã€msgä¸‰ä¸ªå±æ€§
  if (data.code !== 200) {
    ElMessage.error(data.msg)
    return Promise.reject(data.msg)
  }
  return response
}, async (error) => {...})
```

## ant-design

reactä½¿ç”¨ant-designæ—¶ï¼Œå¦‚æœè¡¨å•æ•°æ®æœ¬åœ°çš„æ˜¯æ—¥æœŸæ—¶é—´ç»„ä»¶ï¼Œå…¶è¡¨å•é¡¹æ•°æ®æ˜¯dayjsæ ¼å¼çš„ï¼Œè€Œä¸æ˜¯æ ¼å¼åŒ–çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨`dayjs()`å‡½æ•°æ ¼å¼åŒ–ä¸ºæ—¥æœŸå­—ç¬¦ä¸²ã€‚

## echarts

### å›¾è¡¨å°ºå¯¸ä¸å˜åŒ–

å›¾è¡¨çš„å°ºå¯¸ä¸ä¼šéšçª—å£å¤§å°çš„æ”¹å˜è€Œè‡ªåŠ¨æ”¹å˜ã€‚

è§£å†³æ–¹æ³•ï¼šç›‘å¬çª—å£çš„resizeäº‹ä»¶ï¼Œæ‰‹åŠ¨è°ƒç”¨å›¾è¡¨çš„resizeæ–¹æ³•

~~~js
// æ³¨æ„ï¼Œåœ¨vueä¸­ï¼Œè¦ç”¨ç®­å¤´å‡½æ•°ã€‚å› ä¸ºä¸ç”¨thisæ˜¯windowsï¼Œå®ƒå¹¶æ²¡æœ‰æŒ‚è½½chartå¯¹è±¡
mounted () {
    window.onresize = () => {
        this.chart.resize()
    }
},
methods: {
    createChart () {
        const chartBox = document.getElementById('chart-box')
        this.chart = echarts.init(chartBox)
        this.chart.setOption({...})
    }
}
~~~



## Idea

ideaåˆ›å»ºé»˜è®¤æ˜¯npmï¼Œå¦‚æœæƒ³ä½¿ç”¨å…¶ä»–æ„å»ºå™¨ï¼ˆyarnã€pnpmç­‰ï¼‰ï¼Œåˆ›å»ºé¡¹ç›®çš„æ—¶å€™æŠŠ `npx create-vite` æ”¹ä¸º `npx pnpm create vue`

## css

### z-indexä¸ç”Ÿæ•ˆ

åŸå› ï¼š

- **èƒŒæ™¯è‰²æ²¡è®¾ç½®**ï¼ˆä¸€å®šè¦å…ˆæ’é™¤è¿™ä¸ªï¼Œæ²¡è®¾ç½®èƒŒæ™¯è‰²é»˜è®¤æ˜¯é€æ˜çš„ï¼Œå¯¼è‡´å¥½åƒæ˜¯z-indexæ²¡ç”Ÿæ•ˆï¼‰
- å…¶ä»–åŸå› å‚è€ƒï¼š[ä¸ºä»€ä¹ˆæˆ‘å†™çš„z-indexä¸ç”Ÿæ•ˆï¼Ÿ - å—ç–çš„å‰ç«¯blog - SegmentFault æ€å¦](https://segmentfault.com/a/1190000042584801)

### å¹³ç§»åç•™ä¸‹ç©ºç™½

è™½ç„¶è¯¥å…ƒç´ å¹³ç§»äº†ï¼Œä½†å®ƒåŸæ¥çš„ä½ç½®ä»ç„¶ä¿ç•™åœ¨æ–‡æ¡£æµä¸­ï¼Œå› æ­¤ä¼šå‡ºç°ç©ºç™½åŒºåŸŸã€‚è¿™æ˜¯å› ä¸º `transform` å±æ€§ä¸ä¼šæ”¹å˜å…ƒç´ åœ¨æ–‡æ¡£æµä¸­çš„å®é™…ä½ç½®æˆ–å¸ƒå±€ï¼Œåªæ˜¯æ”¹å˜äº†å®ƒçš„è§†è§‰ä½ç½®ã€‚

è§£å†³æ–¹æ³•ï¼šä¸ä½¿ç”¨`transform: translateX(-300px)`è¿›è¡Œå¹³ç§»ï¼Œæ”¹ç”¨`margin-left: -300px`

# è¡¥å……

## åº“

### Element-UI

#### åŠ¨æ€æ¸²æŸ“ç»„ä»¶

ä¾‹å¦‚åŠ¨æ€æ¸²æŸ“å›¾æ ‡ç»„ä»¶ï¼š

1. æå‰å¯¼å¥½ç»„ä»¶ï¼ˆæˆ–è‡ªåŠ¨å¯¼å…¥/å…¨éƒ¨å¯¼å…¥ï¼‰
2. å‡†å¤‡å¥½åŠ¨æ€æ•°æ®ï¼ˆå­—ç¬¦ä¸²æ•°æ®ï¼‰
3. templateæ ‡ç­¾ä¸­ä½¿ç”¨

~~~vue
<!-- :isç”¨äºæŒ‡å®šæ¸²æŸ“ -->
<el-icon><component :is="menu.icon"></component></el-icon>
~~~

### JQuery miniui

#### è®¾ç½®å›¾æ ‡

ç»™treeç­‰ç»„ä»¶è®¾ç½®å›¾æ ‡çš„æ–¹æ³•ï¼šç»™èŠ‚ç‚¹æ•°æ®åŠ ä¸ŠiconClså±æ€§ï¼Œå€¼ä¸ºclassåç§°ï¼Œé€šè¿‡ç»™è®¾ç½®çš„classåŠ ä¸Šç›¸åº”çš„csså±æ€§å°±å¯ä»¥è®¾ç½®å›¾æ ‡äº†ã€‚

ç¤ºä¾‹ï¼š

~~~java
List<Map<String, Object>> list = bdsoftMybatisUtils.selectList("ipad.config.selectDocumentList");
// æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®å›¾æ ‡
list.forEach(map -> {
    // å¦‚æœæ˜¯æ–‡ä»¶å¤¹
    if ("1".equals(map.get("ISFOLDER").toString())) {
        map.put("iconCls", "mini-tree-folder");
    }
});
return JSONHelper.ListToJsonString(list);
~~~

~~~css
.mini-tree-folder {
    background-image: url(images/tree/folder.gif);
}
~~~

### jsPDF

å¯ä»¥åœ¨å‰ç«¯åˆ›å»ºPDFæ–‡æ¡£ã€‚

å‚è€ƒæ–‡ç« ï¼š[è§£å†³jspdfä¸­æ–‡ä¹±ç ã€è¡¨æ ¼ä¸­æ–‡ä¹±ç ï¼--ç»ˆæç‰ˆï¼ï¼_jspdf ä¸­æ–‡ä¹±ç -CSDNåšå®¢](https://blog.csdn.net/huanhuan03/article/details/105841653)

> å¦‚æœæƒ³è¦ä½¿ç”¨jsPDFçš„`autoTable`åŠŸèƒ½éœ€è¦å¯¼å…¥`jsPDF-AutoTable` 
>
> - githubåœ°å€ï¼š[GitHub - simonbengtsson/jsPDF-AutoTable: jsPDF plugin for generating PDF tables with javascript](https://github.com/simonbengtsson/jsPDF-AutoTable)
> - å®‰è£…ï¼š`npm i jspdf-autotable`
>
> è¡¥å……ï¼šå¦ä¸€ä¸ªåˆ›å»ºPDFçš„åº“`pdfMake`ï¼Œhttps://blog.csdn.net/mochenangel/article/details/118634758

1. å®‰è£…ï¼š`npm i jspdf`
2. å‰ç½®æ­¥éª¤ï¼šé»˜è®¤ä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€è¦è·å¾—æ”¯æŒä¸­æ–‡ttfæ–‡ä»¶çš„base64ç¼–ç ã€‚
   * è½¬æ¢åœ°å€ï¼šç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè¿™æ˜¯å®˜æ–¹çš„ [jsPDFå®˜æ–¹è½¬æ¢](https://rawgit.com/MrRio/jsPDF/master/fontconverter/fontconverter.html)ï¼Œè½¬æ¢åä¼šå¾—åˆ°ä¸€ä¸ªjsæ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªfontçš„å˜é‡ï¼Œæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯å®ƒï¼Œå¯ä»¥æŠŠå®ƒå¯¼å‡ºã€‚
   * å¦‚æœè½¬æ¢å‡ºçš„jsæ–‡ä»¶å¤ªå¤§ï¼Œå¯èƒ½è¿è¡Œé¡¹ç›®ä¼šå‡ºç°æ ˆå†…å­˜æº¢å‡ºçš„æŠ¥é”™ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©å­—ä½“åº“çš„éƒ¨åˆ†å­—ç¬¦æ¥å‹ç¼©åŸ`ttf`çš„å¤§å°ï¼š[å­—ä½“å‹ç¼©](https://www.fontspider.vip/)

3. ä½¿ç”¨

~~~js
import { jsPDF } from 'jspdf'
import { autoTable } from 'jspdf-autotable'
import { font } from './font/song-normal'

const doc = new jsPDF()
// fontå³è½¬æ¢å‡ºæ¥çš„jsä¸­é‚£ä¸ªå­˜å‚¨base64ç¼–ç çš„å˜é‡
doc.addFileToVFS('song.ttf', font)	// å‚æ•°1: å­—ä½“æ–‡ä»¶åéšæ„å–
// å‚æ•°1è¦ä¸Šé¢å®šä¹‰çš„åç§°ä¸€è‡´ï¼›å‚æ•°2æ˜¯å­—ä½“åï¼Œéšä¾¿å–ï¼›å‚æ•°3éå¿…è¦ä¸ç”¨æ”¹
doc.addFont('song.ttf', 'custom', 'normal')
doc.setFont('custom')	// è®¾ç½®ä½¿ç”¨çš„å­—ä½“

// æ·»åŠ æ ‡é¢˜
doc.setFontSize(16)
doc.text('æœºåŠ¨è½¦ç¼´è´¹å‘ç¥¨', 105, 10, { align: 'center' })

// æ·»åŠ æ•°æ®é¡¹
doc.setFontSize(12)
doc.text(`ç¼´è´¹äººï¼šå¼ ä¸‰`, 10, 30)
doc.text(`ç¼´è´¹æ—¶é—´ï¼š${this.invoiceData.paymentTime}`, 10, 40)
doc.text(`æ“ä½œæ—¶é—´ï¼š${this.invoiceData.operationTime}`, 10, 50)
doc.text(`å‘ç¥¨ç¼–å·ï¼š${this.invoiceData.invoiceNumber}`, 10, 60)
doc.text(`ç¼´çº³é‡‘é¢ï¼šï¿¥${this.invoiceData.amount}`, 10, 70)

// è¡¨æ ¼
autoTable(doc, {
    head: [['ç½šå•ç¼–å·', 'è½¦ç‰Œå·', 'ç¼´è´¹é‡‘é¢']],
    body: this.invoiceData.tickets.map(ticket => [ticket.id, ticket.plateNumber, `ï¿¥${ticket.paymentMoney}`]),
    startY: 80,
    theme: 'grid', // ä½¿ç”¨ç½‘æ ¼ä¸»é¢˜
    styles: { font: 'custom' }	// è¿™ä¸ªæ’ä»¶é»˜è®¤ä¹Ÿä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€è¦æŒ‡å®šå­—ä½“
})

//doc.output('dataurlnewwindow')	// æ–°çª—å£é¢„è§ˆpdf

// ä¿å­˜ PDF æ–‡æ¡£
doc.save('vehicle_payment_invoice.pdf')
~~~

> æŒ‡å®šäº†å­—ä½“åï¼Œè¡¨å¤´ä»ä¼šä¹±ç ï¼Œéœ€è¦ä¿®æ”¹æºä»£ç æ–‡ä»¶`jspdf.plugin.autotable.js`ï¼Œå°†é‡Œé¢`getTheme`å‡½æ•°ä¸­çš„`bold`å…¨éƒ¨æ”¹æˆ`normal`å³å¯ã€‚

## å·¥å…·

### json-server

å¯ä»¥æ ¹æ®jsonæ–‡ä»¶ç”ŸæˆRestfulé£æ ¼çš„åç«¯æœåŠ¡ã€‚

~~~bash
npm i json-server -g
json-server --watch xxx.json
~~~

~~~json
{
    "stu": {
        "name": "lisi",
        "age": 12
    }
}
~~~

### serve

å¯ä»¥æŠŠæ‰“åŒ…åçš„é™æ€æ–‡ä»¶ä½œä¸ºæœåŠ¡å™¨èµ„æºè¿è¡Œèµ·æ¥ã€‚(expressä¹Ÿè¡Œ)

~~~bash
npm i serve -g
serve æ ¹æ–‡ä»¶å¤¹
~~~

### nrm

ç”¨äºç®¡ç†npmæºã€‚

~~~bash
# æ˜¾ç¤ºæ‰€æœ‰çš„æº
nrm ls
# æŸ¥çœ‹å½“å‰æº
nrm current
# æ·»åŠ æº
nrm add æºå æºåœ°å€
nrm del æºå
nrm test æºå
# æµ‹è¯•å„ä¸ªæºçš„é€Ÿåº¦
nrm test
# åˆ‡æ¢npmæº
nrm use æºå
~~~

### nvm

ç®¡ç†å’Œåˆ‡æ¢nodeç‰ˆæœ¬ã€‚

1. å®‰è£…ï¼š[ä¸‹è½½æœ€æ–°çš„ nvm (github.com)](https://github.com/coreybutler/nvm-windows/releases)

2. æ‰“å¼€nvmçš„å®‰è£…ç›®å½•ä¸‹çš„settings.txtæ–‡ä»¶ï¼Œé…ç½®nodeå’Œnpmçš„ä¸‹è½½åœ°å€ï¼š

~~~bash
root: F:\nvm
path: F:\nodejs
node_mirror: https://npmmirror.com/mirrors/node/
npm_mirror: https://npmmirror.com/mirrors/npm/
~~~

3. é€‰æ‹©nodeç‰ˆæœ¬å¹¶å®‰è£…ï¼ˆæ³¨æ„ï¼šç¬¬ä¸€æ¬¡å®‰è£…éœ€è¦ç”¨`nvm use`åˆ‡æ¢ä¸‹ç‰ˆæœ¬å’Œä½¿ç”¨`nvm on`æ‰“å¼€ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼‰

~~~bash
# æŸ¥çœ‹å¯ä»¥å®‰è£…çš„nodeç‰ˆæœ¬
nvm list available
nvm install ç‰ˆæœ¬å·
nvm uninstall ç‰ˆæœ¬å·
# åˆ‡æ¢nodeç‰ˆæœ¬
nvm use ç‰ˆæœ¬å·
# æŸ¥çœ‹å·²ç»å®‰è£…äº†node
nvm list
~~~

4. é…ç½®å…¨å±€åŒ…è·¯å¾„ï¼Œä½¿æ‰€æœ‰nodeå…±ç”¨åŒä¸€ä¸ªåŒ…è·¯å¾„

~~~bash
# é…ç½®ç”¨npmä¸‹è½½åŒ…æ—¶å…¨å±€å®‰è£…çš„åŒ…è·¯å¾„
npm config set prefix "D:\npm"
npm config set registry https://registry.npmmirror.com
# æ·»åŠ ç¯å¢ƒå˜é‡
ç”¨æˆ·å˜é‡ä¸­æ·»åŠ ï¼šNPM_HOME=D:\npm
pathä¸­æ·»åŠ ï¼š%NPM_HOME%
~~~

### Multer

ä½¿ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥è®©`express.js`å¯ä»¥æ¥æ”¶é€šè¿‡`formData`å‘é€çš„æ–‡ä»¶ã€‚

å®‰è£…ï¼š`pnpm add multer`ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ES6çš„å¯¼å…¥è¯­æ³•æˆ–æ˜¯tsé¡¹ç›®ï¼Œè¿˜éœ€è¦`pnpm add -D @types/multer`

ä½¿ç”¨ï¼š

~~~js
import multer from 'multer'

const storage = multer.memoryStorage()	// æ–‡ä»¶å­˜å‚¨åˆ°å†…å­˜
const upload = multer({ storage })

xxxRouter.post('/upload', upload.single('file'), async (req, res) => {
  const file = req.file
  // formdataçš„å…¶ä»–éæ–‡ä»¶å­—æ®µåˆ™åœ¨body
  const otherField = req.body.purpose
  console.log(new TextDecoder().decode(file!!.buffer))
  console.log(otherField)
})
~~~



## åŸç†

### è·¯ç”±

#### history

å®ç°åˆ‡æ¢é¡µé¢æ—¶ä¸è¿›è¡Œè·³è½¬å’Œåˆ·æ–°ï¼Œè€Œåªæ”¹å˜æµè§ˆå™¨çš„æ˜¾ç¤ºåœ°å€ï¼Œå¹¶ä¸”å¯ä»¥ç›‘å¬åˆ°è·¯å¾„çš„æ”¹å˜ã€‚è¿™é‡Œä»¥aæ ‡ç­¾ä¸¾ä¾‹ï¼š

> æ³¨æ„ï¼šè¿™ç§æ˜¯ç”¨h5çš„`history`Apiå®ç°çš„ï¼ŒæŸäº›è€ç‰ˆæœ¬æµè§ˆå™¨å¹¶ä¸æ”¯æŒã€‚

~~~html
<a href="https://baidu.com" id="myLink">ç‚¹å‡»è¿™é‡Œä¸è·³è½¬ï¼Œä½†æ”¹å˜URL</a>

<script>
    document.getElementById('myLink').addEventListener('click', e => {
        // é˜»æ­¢<a>æ ‡ç­¾çš„é»˜è®¤è¡Œä¸ºï¼ˆå³é¡µé¢è·³è½¬ï¼‰  
        e.preventDefault()
        // ä½¿ç”¨history.pushState()æ”¹å˜åœ°å€æ çš„URL  
        // æ³¨æ„ï¼šå‚æ•°ï¼šçŠ¶æ€å¯¹è±¡ï¼ˆå¯ä»¥ä¸ºnullï¼‰ã€æ ‡é¢˜ï¼ˆå¤§å¤šæ•°æµè§ˆå™¨ä¼šå¿½ç•¥ï¼‰ã€æ–°URL  
        history.pushState(null, '', "test")
        // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
        document.dispatchEvent(new CustomEvent('urlchange', { detail: { newUrl: window.location.href } }))
    })
    document.addEventListener('urlchange', e => {
        console.log('URLå·²æ›´æ”¹:', e.detail.newUrl)
    })
</script>
~~~

æ³¨ï¼š

- windowå¯¹è±¡çš„`popstate`äº‹ä»¶ï¼Œå®ƒä¼šåœ¨ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨çš„å‰è¿›/åé€€æŒ‰é’®æˆ–è€…é€šè¿‡è„šæœ¬è°ƒç”¨`history.back()`, `history.forward()`, `history.go()`æ—¶è§¦å‘ã€‚
- `history.pushState()` æˆ– `history.replaceState()` æ–¹æ³•åªèƒ½é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶ç›‘å¬ã€‚

#### å“ˆå¸Œæ¨¡å¼

åˆ©ç”¨é”šç‚¹å®ç°ï¼Œä¼šå¤šä¸ª`#`å·ã€‚

è¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥ç•™ä¸‹å†å²è®°å½•ï¼Œå¹¶ä¸”å…¼å®¹æ€§å¥½ã€‚

~~~html
<a href="http://www.baidu.com" id="myLink">ç‚¹å‡»è¿™é‡Œä¸è·³è½¬ï¼Œä½†æ”¹å˜URL</a>

  <script>
    document.getElementById('myLink').addEventListener('click', e => {
      e.preventDefault()
      location.hash = '/#/test'
      // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
      document.dispatchEvent(new CustomEvent('urlchange', { detail: { newUrl: location.href } }))
    })
    document.addEventListener('urlchange', e => {
      console.log('URLå·²æ›´æ”¹:', e.detail.newUrl)
    })
</script>
~~~



## å°æŠ€å·§

### é»˜è®¤è¡Œä¸º

é˜»æ­¢é»˜è®¤è¡Œä¸ºé™¤äº†ä½¿ç”¨`e.preventDefault()`æ–¹æ³•å¤–ï¼Œå¯¹åº”æŸäº›æ ‡ç­¾ï¼Œå¦‚`a`æ ‡ç­¾ï¼Œå¯ä»¥åœ¨ç‚¹å‡»äº‹ä»¶ä¸­è¿”å›`false`æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œä½†ä¸å»ºè®®ï¼ˆè€Œä¸”jsç»‘å®šç‚¹å‡»äº‹ä»¶è¿”å›falseä¹Ÿä¸èƒ½é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼‰ã€‚

~~~html
a href="http://www.baidu.com" id="myLink">ç‚¹å‡»è¿™é‡Œä¸è·³è½¬ï¼Œä½†æ”¹å˜URL</a>

<script>
    document.getElementById('myLink').addEventListener('click', e => {
        //æ­¤æ–¹å¼å¹¶ä¸èƒ½é˜»æ­¢é»˜è®¤è¡Œä¸º
        return false
    })
</script>
~~~

è¿™ç§æ–¹å¼å¯ä»¥é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼š

~~~html
a href="http://www.baidu.com" onclick="return test('test')">ç‚¹å‡»è¿™é‡Œä¸è·³è½¬ï¼Œä½†æ”¹å˜URL</a>

<script>
    function test(val) {
        console.log(val)
        return false
    }
</script>
~~~

### æ·±åº¦é€‰æ‹©å™¨

åœ¨Vue.jsä¸­ï¼Œæ·±åº¦é€‰æ‹©å™¨ï¼ˆdeep selectorï¼‰å…è®¸ä½ ç©¿é€`scoped`æ ·å¼çš„å°è£…ï¼Œä»¥ä¾¿èƒ½å¤Ÿåº”ç”¨åˆ°å­ç»„ä»¶ä¸­çš„å…ƒç´ ã€‚

Vue2ä¸­å¯ä»¥ç”¨`::v-deep`ï¼ˆæ¨èï¼‰ã€`/deep/`ã€`>>>`

Vue3ä¸­åºŸå¼ƒäº†Vue2ä¸­çš„3ç§ç”¨æ³•ï¼Œæ”¹ä¸º`::v-deep(é€‰æ‹©å™¨)`äº†

ä¸¾ä¾‹ï¼š

~~~vue
<style scoped lang="scss">
//vue2ä¸­ï¼š
.item {
  ::v-deep .el-form-item__label {
  color: red;
   }
}
    
//vue3ä¸­ï¼š
.item {
  ::v-deep(.el-form-item__label) {
  color: red; 
  }
}
</style>
~~~

### æµå¼æ•°æ®

å½“å‰ç«¯æ¥æ”¶å¤„ç†æµå¼æ•°æ®ï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿä¾‹å¦‚æ¥æ”¶AIæ¥å£å“åº”çš„æµå¼æ•°æ®ï¼Œå¸¸é—´çš„æœ‰ä¸‰ç§æ–¹æ¡ˆï¼šwebsocketã€SSEã€fetch Stream

å¯ä»¥å‚è€ƒï¼š[ChatGPT å‰ç«¯æµå¼æ•°æ®å¦‚ä½•å¤„ç†ï¼Ÿæœ¬æ–‡æä¾›ä¸‰ç§æ–¹æ¡ˆä¸ºä½ æ­å¼€ç–‘æƒ‘ã€websocketã€SSEã€fetch Stream\]_chatgpt-next-webæµå¼-CSDNåšå®¢](https://blog.csdn.net/SAXX2/article/details/132693429)

ä»¥ä¸‹æ˜¯ä½¿ç”¨fetchæ¥å¤„ç†åƒå¸†å¤§æ¨¡å‹çš„æµå¼æ•°æ®ï¼š

~~~javascript
// body-è¯·æ±‚ä½“ï¼Œcb-å›è°ƒå‡½æ•°ï¼Œå‚æ•°ä¸ºjså¯¹è±¡
async (api_key, secret_key, body, cb) => {
  const { data } = await getAccessToken(api_key, secret_key)

  const resp = await fetch(`https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/qianfan-agent-speed-8k?access_token=${data.access_token}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(body)
  })
  const reader = resp.body?.getReader()
  const decoder = new TextDecoder()
  while (true) {
    const { done, value } = await reader?.read() as { done: boolean, value: Uint8Array }
    if (done) break
    let strs = decoder.decode(value).split('\n\n')
    for (let i = 0; i < strs.length - 1; i++) {
      const res = JSON.parse(strs[i].slice(6))
      cb(res)
    }
  }
}
~~~



## åŠŸèƒ½

### æ‰“å°å‘ç¥¨

å‚è€ƒæ–‡ç« ï¼š[åŠŸèƒ½ï¼švueï¼šæµè§ˆå™¨æ‰“å°å°ç¥¨ã€æ‰“å°å‚æ•°é…ç½®_vueå‘ç¥¨é¡µé¢-CSDNåšå®¢](https://blog.csdn.net/qq_43548684/article/details/128317065)

~~~vue
<template>
<el-dialog title="æ‰“å°å‘ç¥¨" :visible.sync="dialogPrintVisible">
    <Print id="print-box" ref="receipt" :receipt="receipt" />
    <div slot="footer" class="dialog-footer">
        <el-button @click="dialogPrintVisible = false">å–æ¶ˆ</el-button>
        <el-button type="success" @click="printReceipt">æ‰“å°</el-button>
    </div>
</el-dialog>
</template>

<script>
export default {
    methods: {
        printReceipt () {
            const receiptNode = this.$refs.receipt.$el
            if (!receiptNode) return
            const iframe = document.createElement('iframe')
            document.body.appendChild(iframe)
            // å°†æ‰“å°é¡µé¢è®¾ç½®ä¸ºå†…æ¡†æ¶å†…å®¹
            const doc = iframe.contentWindow.document
            doc.write(`
              <style type="text/css">
                /* æ‰“å°é¡µé¢æ ·å¼ */
                /*......*/
              </style>
            `)
            doc.close()
            doc.body.append(receiptNode.cloneNode(true))
            // æµè§ˆå™¨æ‰“å°é¡µé¢æ‰“å¼€æ¸²æŸ“
            setTimeout(() => {
                iframe.contentWindow.focus()
                iframe.contentWindow.print()
                document.body.removeChild(iframe) // ç§»é™¤æ‰“å°å†…æ¡†æ¶ï¼Œä¸‹æ¬¡æ‰“å°ä¸‹æ¬¡å†æŒ‚è½½
            }, 10)
    	}
    }
}
</script>
~~~

print.vue:

~~~vue
<template>
  <!-- æ‰“å°é¢„è§ˆ -->
  <div class="print-wrap" ref="print">
    <div class="receipt-title">ç¼´è´¹å‘ç¥¨</div>
    <div class="divide-line">--------------------------------------------------------</div>
    <div class="base-info">
      <div>æ‰“å°æ—¶é—´ï¼š{{ receipt.printTime }}</div>
      <div>æ“ä½œäººï¼š{{ receipt.printUser }}</div>
    </div>
    <div class="divide-line">--------------------------------------------------------</div>
    <div class="payment-info">
      <div>ç¼´è´¹æ—¶é—´ï¼š{{ receipt.paymentTime }}</div>
      <div>ç¼´è´¹é‡‘é¢ï¼š{{ receipt.paymentMoney }}</div>
      <div>ç¼´è´¹äººï¼š{{ receipt.paymentUser }}</div>
    </div>
  </div>
</template>

<script>
export default {
  props: {
    receipt: {}
  }
}
</script>
~~~



#  å¸¸ç”¨æ’ä»¶

## ESlint

ESLintï¼šæŒ‰eslintè§„èŒƒè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼ˆvscodeæ’ä»¶ï¼‰

~~~json
// ESLint & prettier é…ç½®ä»£ç é£æ ¼
// 1ã€å®‰è£…äº†æ’ä»¶ ESlintï¼Œå¼€å¯ä¿å­˜è‡ªåŠ¨ä¿®å¤ï¼›ç¦ç”¨äº†æ’ä»¶ Prettierï¼Œå¹¶å…³é—­ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–
// 2ã€ESlintæ’ä»¶ + Vscodeé…ç½® å®ç°è‡ªåŠ¨æ ¼å¼åŒ–ä¿®å¤
"editor.codeActionsOnSave": {
    "source.fixAll": true
},
"editor.formatOnSave": false
// 3ã€ é…ç½®.eslintrc.cjs
  rules: {
    'prettier/prettier': [
      'warn',
      {
        singleQuote: true, // å•å¼•å·
        semi: false, // æ— åˆ†å·
        printWidth: 80, // æ¯è¡Œå®½åº¦è‡³å¤š80å­—ç¬¦
        trailingComma: 'none', // ä¸åŠ å¯¹è±¡|æ•°ç»„æœ€åé€—å·
        endOfLine: 'auto' // æ¢è¡Œç¬¦å·ä¸é™åˆ¶ï¼ˆwin mac ä¸ä¸€è‡´ï¼‰
      }
    ],
    'vue/multi-word-component-names': [
      'warn',
      {
        ignores: ['index'] // vueç»„ä»¶åç§°å¤šå•è¯ç»„æˆï¼ˆå¿½ç•¥index.vueï¼‰
      }
    ],
    'vue/no-setup-props-destructure': ['off'], // å…³é—­ props è§£æ„çš„æ ¡éªŒ
    // ğŸ’¡ æ·»åŠ æœªå®šä¹‰å˜é‡é”™è¯¯æç¤ºï¼Œcreate-vue@3.6.3 å…³é—­ï¼Œè¿™é‡ŒåŠ ä¸Šæ˜¯ä¸ºäº†æ”¯æŒä¸‹ä¸€ä¸ªç« èŠ‚æ¼”ç¤ºï¼ˆæœ‰äº†è‡ªåŠ¨å¯¼å…¥æ—¶ï¼Œç›´æ¥ä½¿ç”¨ä¼šæŠ¥é”™æœªï¼‰
    'no-undef': 'error'
    // å…³é—­ï¼šâ€˜no-undef': 0
  }
~~~



## husky

husky ï¼šåŸºäº husky  çš„ä»£ç æ£€æŸ¥å·¥ä½œæµ

~~~sh
# husky æ˜¯ä¸€ä¸ª git hooks å·¥å…·  ( gitçš„é’©å­å·¥å…·ï¼Œå¯ä»¥åœ¨ç‰¹å®šæ—¶æœºæ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ )
pnpm dlx husky-init && pnpm install
# ä¿®æ”¹ .husky/pre-commit æ–‡ä»¶ï¼Œæ”¹æ‰åŸæ‰§è¡Œå‘½ä»¤ä¸ºï¼š
pnpm lint
# ä¼˜åŒ–ï¼šlintå‘½ä»¤æ˜¯å¯¹æ‰€æœ‰ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œä¸è®ºæ˜¯å¦å·²æäº¤è¿‡ï¼Œä¼šæœ‰è€—æ—¶é—®é¢˜å’Œå†å²ä»£ç é—®é¢˜

# lint-staged é…ç½®è§£å†³ä¸Šè¿°é—®é¢˜
pnpm i lint-staged -D
# é…ç½®package.json
{
  // ... çœç•¥ ...
  "lint-staged": {
    "*.{js,ts,vue}": [
      "eslint --fix"
    ]
  }
}

{
  "scripts": {
    // ... çœç•¥ ...
    "lint-staged": "lint-staged"
  }
}
# ä¿®æ”¹ .husky/pre-commit æ–‡ä»¶ï¼Œæ”¹æ‰åŸæ‰§è¡Œå‘½ä»¤ä¸ºï¼š
pnpm lint-staged
~~~

## è‡ªåŠ¨å¯¼å…¥

 è‡ªåŠ¨æŒ‰éœ€å¯¼å…¥ç»„ä»¶å’Œæ¨¡å—

~~~sh
pnpm add -D unplugin-vue-components unplugin-auto-import	
# unplugin-vue-componentsï¼šæŒ‰éœ€è‡ªåŠ¨å¼•å…¥Vueç»„ä»¶
# unplugin-auto-importï¼šåŠ¨æ€åœ°è‡ªåŠ¨å¯¼å…¥æœªå£°æ˜çš„æ¨¡å—

# unplugin-auto-importçš„å…·ä½“ä½¿ç”¨æ–¹æ³•è¯·ç™¾åº¦
~~~

## å…¶ä»–

- veturï¼švue2ä»£ç æ’ä»¶ï¼ˆvscodeæ’ä»¶ï¼‰
- volarï¼švue3ä»£ç æ’ä»¶ï¼ˆvscodeæ’ä»¶ï¼‰
- any-ruleï¼šå¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆvscodeæ’ä»¶ï¼‰
- Easy LESSï¼šhtmlã€cssã€js ä»£ç é”™è¯¯è‡ªåŠ¨æç¤ºï¼ˆvscodeæ’ä»¶ï¼‰
- taboutï¼šæŒ‰tabé”®è‡ªåŠ¨é€€å‡ºå¼•å·ã€æ‹¬å·
- live serverï¼šå¯ä»¥å®ç° HTML å†…å®¹éšä»£ç æ”¹å˜è‡ªåŠ¨æ›´æ–°
- IntelliSense for CSS class namesï¼šè‡ªåŠ¨æä¾›CSS classåç§°çš„æ™ºèƒ½æç¤º
